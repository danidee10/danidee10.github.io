<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Flask by example 6 (Connecting React to a REST API)</title>
    <meta name="description" content="Osaetin Daniel's blog">
    <link rel="alternate" type="application/atom+xml" title="Osaetin Daniel" href="/feed.xml" />

    <!--script src="https://use.typekit.net/axu2jbv.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script-->
    <!--link href="https://fonts.googleapis.com/css?family=Cabin" rel="stylesheet"-->
    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet">
    <script src="https://use.fontawesome.com/5bbf16a3a0.js"></script>

    <style>
    /*!
 * end2end - jekyll theme free
 * https://github.com/nandomoreirame/end2end
 * MIT License
 */@import url("//fonts.googleapis.com/css?family=Open+Sans:400,300,700");html{box-sizing:border-box}*,*::after,*::before{box-sizing:inherit}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}.btn,.sliding-panel-button{appearance:none;background-color:#337ab7;border:0;border-radius:3px;color:#fff;cursor:pointer;display:inline-block;font-family:"Open Sans","Helvetica Neue","Helvetica","Roboto","Arial",sans-serif;font-size:1em;-webkit-font-smoothing:antialiased;font-weight:600;line-height:1;padding:.75em 1.5em;text-decoration:none;transition:background-color .2s ease;user-select:none;vertical-align:middle;white-space:nowrap}.btn:hover,.sliding-panel-button:hover,.btn:focus,.sliding-panel-button:focus{background-color:#296292;color:#fff}.btn:disabled,.sliding-panel-button:disabled{cursor:not-allowed;opacity:0.5}.btn:disabled:hover,.sliding-panel-button:disabled:hover{background-color:#337ab7}fieldset{background-color:#f7f7f7;border:1px solid #dedede;margin:0 0 .75em;padding:1.5em}input,label,select{display:block;font-family:"Open Sans","Helvetica Neue","Helvetica","Roboto","Arial",sans-serif;font-size:1em}label{font-weight:600;margin-bottom:.375em}label.required::after{content:"*"}label abbr{display:none}input[type="color"],input[type="date"],input[type="datetime"],input[type="datetime-local"],input[type="email"],input[type="month"],input[type="number"],input[type="password"],input[type="search"],input[type="tel"],input[type="text"],input[type="time"],input[type="url"],input[type="week"],input:not([type]),textarea,select[multiple=multiple]{background-color:#fff;border:1px solid #dedede;border-radius:3px;box-shadow:inset 0 1px 3px rgba(0,0,0,0.06);box-sizing:border-box;font-family:"Open Sans","Helvetica Neue","Helvetica","Roboto","Arial",sans-serif;font-size:1em;margin-bottom:.75em;padding:.5em;transition:border-color .2s ease;width:100%}input[type="color"]:hover,input[type="date"]:hover,input[type="datetime"]:hover,input[type="datetime-local"]:hover,input[type="email"]:hover,input[type="month"]:hover,input[type="number"]:hover,input[type="password"]:hover,input[type="search"]:hover,input[type="tel"]:hover,input[type="text"]:hover,input[type="time"]:hover,input[type="url"]:hover,input[type="week"]:hover,input:not([type]):hover,textarea:hover,select[multiple=multiple]:hover{border-color:#b2b2b2}input[type="color"]:focus,input[type="date"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="email"]:focus,input[type="month"]:focus,input[type="number"]:focus,input[type="password"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="text"]:focus,input[type="time"]:focus,input[type="url"]:focus,input[type="week"]:focus,input:not([type]):focus,textarea:focus,select[multiple=multiple]:focus{border-color:#337ab7;box-shadow:inset 0 1px 3px rgba(0,0,0,0.06),0 0 5px rgba(45,109,163,0.7);outline:none}input[type="color"]:disabled,input[type="date"]:disabled,input[type="datetime"]:disabled,input[type="datetime-local"]:disabled,input[type="email"]:disabled,input[type="month"]:disabled,input[type="number"]:disabled,input[type="password"]:disabled,input[type="search"]:disabled,input[type="tel"]:disabled,input[type="text"]:disabled,input[type="time"]:disabled,input[type="url"]:disabled,input[type="week"]:disabled,input:not([type]):disabled,textarea:disabled,select[multiple=multiple]:disabled{background-color:#f2f2f2;cursor:not-allowed}input[type="color"]:disabled:hover,input[type="date"]:disabled:hover,input[type="datetime"]:disabled:hover,input[type="datetime-local"]:disabled:hover,input[type="email"]:disabled:hover,input[type="month"]:disabled:hover,input[type="number"]:disabled:hover,input[type="password"]:disabled:hover,input[type="search"]:disabled:hover,input[type="tel"]:disabled:hover,input[type="text"]:disabled:hover,input[type="time"]:disabled:hover,input[type="url"]:disabled:hover,input[type="week"]:disabled:hover,input:not([type]):disabled:hover,textarea:disabled:hover,select[multiple=multiple]:disabled:hover{border:1px solid #dedede}textarea{resize:vertical}input[type="search"]{appearance:none}input[type="checkbox"],input[type="radio"]{display:inline;margin-right:.375em}input[type="checkbox"]+label,input[type="radio"]+label{display:inline-block}input[type="file"]{margin-bottom:.75em;width:100%}select{margin-bottom:1.5em;max-width:100%;width:auto}ul,ol{margin:0;padding:0;list-style-position:inside;padding-left:25px}dl{margin-bottom:.75em}dl dt{font-weight:bold;margin-top:.75em}dl dd{margin:0}table{border-collapse:collapse;font-feature-settings:"kern", "liga", "tnum";margin:.75em 0;table-layout:fixed;width:100%}th{border-bottom:1px solid #a7a7a7;font-weight:600;padding:.75em 0;text-align:left}td{border-bottom:1px solid #dedede;padding:.75em 0}tr,td,th{vertical-align:middle}body{color:#000000;font-size:18px;font-weight:400;line-height:1.5}h1,h2,h3,h4,h5,h6{font-family:"Open Sans","Helvetica Neue","Helvetica","Roboto","Arial",sans-serif;font-size:1em;line-height:1.2;font-weight:700;margin:0 0 .75em}h1{font-size:35px; color: #337ab7;}h2{font-size:1.625rem}h3{font-size:1.5rem}h4{font-size:1.25rem}h5,h6{font-size:1rem}p{margin:0 0 .75em;font-weight:300}em{font-style:italic}small{font-size:80%}a{color:#337ab7;text-decoration:none;-webkit-transition:color .2s ease;-moz-transition:color .2s ease;transition:color .2s ease}a:active,a:focus,a:hover{color:#265c89}hr{border-bottom:1px solid #dedede;border-left:0;border-right:0;border-top:0;margin:1.5em 0}img,picture{margin:0;max-width:100%}code{background:none;border-radius:0;border:none;font-family:"Courier New", monospace;font-size:0.9em;margin:0;padding:0 5px;background-color:#ededed}pre{-webkit-overflow-scrolling:touch;font-family:"Courier New", monospace;font-size:0.9em;margin:0}pre code{line-height:1.75em}.txt-primary{color:#337ab7}.txt-white{color:#fff}.txt-black{color:#000}.txt-blue{color:#477dca}.txt-dark-gray{color:#232323}.txt-medium-gray{color:#9a9a9a}.txt-light-gray{color:#dedede}.txt-left{text-align:left}.txt-right{text-align:right}.txt-center{text-align:center}.txt-justify{text-align:justify}.word-wrap{overflow-wrap:break-word;word-wrap:break-word;word-break:break-all}.dot{border-radius:50%}blockquote{background:#f9f9f9;border-left:10px solid #ccc;margin:1.5em 10px;padding:0.5em 10px;quotes:"“" "”" "‘" "’"}blockquote:before{color:#ccc;content:open-quote;font-size:4em;line-height:0.1em;margin-right:0.25em;vertical-align:-0.4em}blockquote p{display:inline}.site-header::after,.social::after,.pagination::after,.highlight::after{clear:both;content:"";display:table}html,body{min-height:100%;height:100%}body{border-top:5px solid #337ab7;background:#fff url("/images/bg-pattern1.png.png")}.container{max-width:800px;margin-left:auto;margin-right:auto;padding-left:.75em;padding-right:.75em}.container::after{clear:both;content:"";display:table}.card,.post-list .post{background-color:#fff;box-shadow:0 2px 1px rgba(0,0,0,0.1);margin:0 0 1.5em;padding:1.5em .75em}@media screen and (min-width: 480px){.card,.post-list .post{padding:1.5em}}.site-header{background-color:#fff;padding:0.3em 0;margin-bottom:1.5em;border-bottom:1px solid rgba(222,222,222,0.5)}.site-header h1{margin:0;padding:5px 0;float:left;font-weight:400;font-size:1.25rem}.site-header h1 span{color:#337ab7}.site-header h1,.site-header a{text-transform:lowercase}.site-header .navbar{float:right}.site-header a{color:#9a9a9a}.site-header a:hover,.site-header a:focus,.site-header a:active{color:#232323}@media screen and (max-width: 480px){.site-header .container{padding-left:1.5em;padding-right:1.5em}}.sliding-panel-button{float:right;padding:5px;margin:0 3.75em 0 0}.sliding-panel-button span{width:30px;display:block;height:3px;border-radius:2px;background:#fff;margin:3px 0}@media screen and (min-width: 480px){.sliding-panel-button{display:none}}@media screen and (max-width: 480px){.sliding-panel-content{border-top:5px solid #337ab7;position:fixed;top:0;right:auto;bottom:0;left:0;height:100%;width:220px;-webkit-transform:translateX(-100%);-moz-transform:translateX(-100%);-ms-transform:translateX(-100%);-o-transform:translateX(-100%);transform:translateX(-100%);-webkit-transition:all 0.25s linear;-moz-transition:all 0.25s linear;transition:all 0.25s linear;background:#fff;-webkit-overflow-scrolling:touch;overflow-y:auto;z-index:999999}.sliding-panel-content.is-visible{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);-o-transform:translateX(0);transform:translateX(0)}.sliding-panel-fade-screen{position:fixed;top:0;right:0;bottom:0;left:0;-webkit-transition:all 0.15s ease-out 0s;-moz-transition:all 0.15s ease-out 0s;transition:all 0.15s ease-out 0s;background:#000;opacity:0;visibility:hidden;z-index:9999}.sliding-panel-fade-screen.is-visible{opacity:0.4;visibility:visible}.sliding-panel-close{cursor:pointer}}.navbar li,.navbar a{display:inline-block}.navbar a{padding:5px 15px}@media screen and (max-width: 600px){.navbar a{padding:5px 10px}}@media screen and (max-width: 480px){.navbar li,.navbar a{display:block;text-align:center}.navbar li{border-bottom:1px solid #f2f2f2}.navbar a{padding:15px 0}}.btn.btn-ghost,.btn-ghost.sliding-panel-button{background-color:transparent;border:2px solid #337ab7;color:#337ab7;margin-bottom:2px}.btn.disabled,.disabled.sliding-panel-button,.btn[disabled],[disabled].sliding-panel-button,fieldset[disabled] .btn,fieldset[disabled] .sliding-panel-button{cursor:not-allowed;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none;opacity:.65}body.home{width:100%;display:table}.hero{text-align:center;display:table-cell;vertical-align:middle}.hero-inner{text-align:center;display:inline-block;padding:1.5em}.hero-inner .dot{padding:5px;border:1px solid #dedede}.hero-inner h1{margin-top:.7em;font-size:2.5rem}.hero-inner h3{font-size:1.25rem;margin:.8em 0 1.2em}@media screen and (min-width: 600px){.hero-inner h3{font-size:1.5rem}}.hero-inner h3,.hero-inner em{font-weight:300}.hero-inner em{color:#337ab7}.hero-inner strong{font-weight:700}.post{padding:1.5em 0}.post-header{margin-bottom:1.5em; padding-bottom: 5px; border-bottom: 1px solid #999;}.post-title{font-size:1.625rem;margin-bottom:0;line-height:1.5em}.post-list .post a{color:#636363}.post-list .post a:hover,.post-list .post a:active,.post-list .post a:focus{color:#337ab7}.social{padding:1.5em 0}.social li{display:inline-block;padding:0 .6em}.social a{color:#9a9a9a}.social a:hover,.social a:active,.social a:focus{color:#337ab7}.social i{font-size:1.2em}.pagination{text-align:center;margin:2em 0}.pagination li{padding:0 .4em}.pagination li,.pagination a,.pagination span{display:inline-block}.pagination a,.pagination span{line-height:1.2em;font-size:.75rem}.pagination .btn,.pagination .sliding-panel-button{color:#636363;border-color:rgba(222,222,222,0.8)}.pagination span{color:#aaa;font-style:italic}.site-footer{background-color:#fff;border-top:1px solid rgba(222,222,222,0.5);padding:1.5em;text-align:center}.site-footer p{margin:0}.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width: 500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}@font-face{font-family:"end2end-icons";src:url("../fonts/end2end-icons.eot?vs69d0");src:url("../fonts/end2end-icons.eot?vs69d0#iefix") format("embedded-opentype"),url("../fonts/end2end-icons.ttf?vs69d0") format("truetype"),url("../fonts/end2end-icons.woff?vs69d0") format("woff"),url("../fonts/end2end-icons.svg?vs69d0#end2end-icons") format("svg");font-weight:normal;font-style:normal}.icon{font-family:"end2end-icons" !important;speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-home:before{content:""}.icon-comments:before{content:""}.icon-comment-o:before{content:""}.icon-comments-o:before{content:""}.icon-search:before{content:""}.icon-share:before{content:""}.icon-google-plus:before{content:""}.icon-facebook:before{content:""}.icon-facebook-rounded:before{content:""}.icon-twitter:before{content:""}.icon-twitter-rounded:before{content:""}.icon-feed:before{content:""}.icon-github:before{content:""}.icon-linkedin:before{content:""}.highlight{padding:0;margin-top:1.2em;margin-bottom:1.2em}.highlight,.highlight .hll,.highlight pre,.highlight code{background-color:#272822 !important;border:none}.highlight pre{margin:0;padding:1.3em;white-space:pre;line-height:23px;overflow-x:auto;margin-bottom:0;word-break:inherit;word-wrap:inherit}.highlight pre,.highlight pre code{color:#eeffdd}.highlight pre code{white-space:pre;padding:0 !important}.highlight pre code *{white-space:nowrap}.highlight .c{color:#75715e}.highlight .err{color:#f2f1f2}.highlight .k{color:#66d9ef}.highlight .l{color:#ae81ff}.highlight .n{color:#f8f8f2}.highlight .o{color:#f92672}.highlight .p{color:#f8f8f2}.highlight .cm{color:#75715e}.highlight .cp{color:#75715e}.highlight .c1{color:#75715e}.highlight .cs{color:#75715e}.highlight .ge{font-style:italic}.highlight .gs{font-weight:bold}.highlight .kc{color:#66d9ef}.highlight .kd{color:#66d9ef}.highlight .kn{color:#f92672}.highlight .kp{color:#66d9ef}.highlight .kr{color:#66d9ef}.highlight .kt{color:#66d9ef}.highlight .ld{color:#e6db74}.highlight .m{color:#ae81ff}.highlight .s{color:#e6db74}.highlight .na{color:#a6e22e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#a6e22e}.highlight .no{color:#66d9ef}.highlight .nd{color:#a6e22e}.highlight .ni{color:#f8f8f2}.highlight .ne{color:#a6e22e}.highlight .nf{color:#a6e22e}.highlight .nl{color:#f8f8f2}.highlight .nn{color:#f8f8f2}.highlight .nx{color:#a6e22e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f92672}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f92672}.highlight .w{color:#f8f8f2}.highlight .mf{color:#ae81ff}.highlight .mh{color:#ae81ff}.highlight .mi{color:#ae81ff}.highlight .mo{color:#ae81ff}.highlight .sb{color:#e6db74}.highlight .sc{color:#e6db74}.highlight .sd{color:#e6db74}.highlight .s2{color:#e6db74}.highlight .se{color:#ae81ff}.highlight .sh{color:#e6db74}.highlight .si{color:#e6db74}.highlight .sx{color:#e6db74}.highlight .sr{color:#e6db74}.highlight .s1{color:#e6db74}.highlight .ss{color:#e6db74}.highlight .bp{color:#f8f8f2}.highlight .vc{color:#f8f8f2}.highlight .vg{color:#f8f8f2}.highlight .vi{color:#f8f8f2}.highlight .il{color:#ae81ff}.highlight .gu{color:#75715e}.highlight .gd{color:#f92672}.highlight .gi{color:#a6e22e}

body {
  /*font-family: brandon-grotesque, "Brandon Grotesque", "Helvetica Neue", Helvetica, Arial, "Lucida Sans", Geneva, Verdana, sans-serif; */
  font-family: 'Josefin Sans', sans-serif;
  font-size: 20px;
}

.container {
  max-width: 950px;
}

.post-meta {
  font-style: italic;
  font-size: 16px;
}

strong {
  font-weight: bold;
}

a {
  font-weight: bold;
}

.postlist {
  list-style: inside;
  font-style: italic;
}

    </style>

    <link rel="canonical" href="https://danidee10.github.io/2016/10/26/flask-by-example-6.html">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-83888894-1', 'auto');
      ga('send', 'pageview');

    </script>

  </head>


    <main>
      <header class="site-header">
  <div class="container">
    <h1><a href="/">Osaetin<span>Daniel</span></a></h1>

    <button type="button" class="sliding-panel-button">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <nav class="navbar sliding-panel-content">
      <ul>

          <li><a href="/about" title="About">About</a></li>

          <li><a href="/blog" title="Blog">Blog</a></li>

        <!--rssfeed li><a href="/end2end/feed.xml" target="_blank"><i class="icon icon-feed"></i></a></li-->
      </ul>
    </nav>
  </div>
</header>


      <div class="sliding-panel-fade-screen"></div>

      <div class="container">
        <article role="article" class="post">
          <div class="card">
            <header class="post-header">
              <h1 class="post-title">Flask by example 6 (Connecting React to a REST API)</h1>
              <p class="post-meta">October 26, 2016</i>
            </header>

            <div class="post-content">
              <p>In this part, we’re going to be connecting our React front-end with the REST api we created previously, basically we’ll make a request to the server and then our api responds with a json result, and then we use the received data to update the DOM if the request was successful or tell the user that something went wrong.</p>

<p><br /></p>

<h3 id="preparation">Preparation</h3>

<p>Before we get on to displaying the polls, we’re going to make some important changes to our application.</p>

<p>First, we’re going to get rid of the div <code class="highlighter-rouge">form_container</code> in <code class="highlighter-rouge">polls.html</code> file and replace it with a div that has an id of <code class="highlighter-rouge">container</code> we are also going to change the id of the <code class="highlighter-rouge">latest_polls</code> div in our <code class="highlighter-rouge">index.html</code> file to <code class="highlighter-rouge">container</code>. we’re doing this so our react componenets have a universal container where they can be rendered into.</p>

<p><em>You might find yourself in a situation where you need to render different components into different containers in your templates (You’ll mostly do this if you’re re-writing some parts of an existing application in React), you can easily create a separate js/jsx file for your component(s) and specify where they should be rendered with <code class="highlighter-rouge">ReactDOM.render</code></em></p>

<p>I also made some improvements to the CSS and html of the application, so please make sure you check out the <a href="https://github.com/danidee10/Votr">Github repo</a> to get the latest html layout and css styles before proceeding.</p>

<p>You’ll also need another React addon called <a href="https://github.com/ReactTraining/react-router">React Router</a> to help us render the right component for the right route (Remember react only handles the view for us….nothing more). It’s available on <code class="highlighter-rouge">npmcdn</code> Just include it at the top of <code class="highlighter-rouge">index.html</code> and <code class="highlighter-rouge">polls.html</code></p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://npmcdn.com/react-router@2.8.1/umd/ReactRouter.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p><br /></p>

<h3 id="saving-the-polls">Saving the polls</h3>
<p>First off, we’re going make sure our users polls are persisted to the database, when the user clicks on save poll, we want to extract the relevant data, make an ajax post request to the server get and display the result of the request (success or failure) as a good old javascript alert.</p>

<p>This code goes into the <code class="highlighter-rouge">handleSubmit</code> method of the <code class="highlighter-rouge">PollForm</code> component</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//global variable to store origin url (e.g http://localhost:5000)</span>
<span class="kd">var</span> <span class="nx">origin</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="p">;</span>


<span class="nl">handleSubmit</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'title'</span><span class="p">:</span> <span class="nx">title</span><span class="p">,</span> <span class="na">options</span><span class="p">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">name</span><span class="p">})};</span>
    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span>  <span class="nx">origin</span> <span class="o">+</span> <span class="s1">'/api/polls'</span>

    <span class="c1">// make post request</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
      <span class="na">dataType</span><span class="p">:</span> <span class="s1">'json'</span><span class="p">,</span>
      <span class="na">type</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
      <span class="na">contentType</span><span class="p">:</span> <span class="s1">'application/json; charset=utf-8'</span><span class="p">,</span>
      <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
      <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">'Poll creation failed: '</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">});</span>
  <span class="p">},</span></code></pre></figure>

<p>We created a global variable <code class="highlighter-rouge">origin</code> to hold the base address of the route and then used it to form the api route, after that we made a post request to our api using JQuery (You could use pure javascript if you want) and on success or failure we simply alert the user and tell them what happened.</p>

<p>We are also going to change the button type of the <code class="highlighter-rouge">Add option</code> button to <code class="highlighter-rouge">"button"</code>. this was done to prevent the button from triggering the submit event which is default action triggered if we don’t specify the function of the button.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">className=</span><span class="s">"row form-group"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">className=</span><span class="s">"btn btn-lg btn-success btn-block"</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">onClick=</span><span class="s">{this.handleOptionAdd}</span><span class="nt">&gt;</span>Add option<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">className=</span><span class="s">"btn btn-lg btn-success btn-block"</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Save poll<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>After doing this, you should be able to create your first poll as a user!</p>

<p><br /></p>

<h2 id="react-router">React router</h2>
<p>Next up, we’re going to display the polls to logged in users on the homepage (only logged in users can vote). React Router helps us render the right component based on the page we’re on.</p>

<p>Include the Relevant imports at the top of the <code class="highlighter-rouge">polls.js</code> file</p>

<p><strong>Note that we’re using version 2 of React router which is quite different from version4 at the time i made this tutorial</strong></p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">ReactRouter</span><span class="p">.</span><span class="nx">Router</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">Route</span> <span class="o">=</span> <span class="nx">ReactRouter</span><span class="p">.</span><span class="nx">Route</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">browserHistory</span> <span class="o">=</span> <span class="nx">ReactRouter</span><span class="p">.</span><span class="nx">browserHistory</span><span class="p">;</span></code></pre></figure>

<p>and change the <code class="highlighter-rouge">ReactDOM.render</code> method to this</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">((</span>
  <span class="o">&lt;</span><span class="nx">Router</span> <span class="nx">history</span><span class="o">=</span><span class="p">{</span><span class="nx">browserHistory</span><span class="p">}</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/polls"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">PollForm</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
  <span class="o">&lt;</span><span class="sr">/Router</span><span class="err">&gt;
</span>
  <span class="p">),</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'container'</span><span class="p">)</span>
<span class="p">);</span></code></pre></figure>

<p>The new <code class="highlighter-rouge">ReactDOM.render</code> method is pretty straight forward, we’re simply telling React that when the user visits the <code class="highlighter-rouge">/polls</code> suburl it should render the <code class="highlighter-rouge">PollForm</code> component into our <code class="highlighter-rouge">container</code> div.</p>

<p>If you’re wondering what <code class="highlighter-rouge">browserHistory</code> means, There’s a detailed example on <code class="highlighter-rouge">browserHistory</code> and other “histories” provided by react router.</p>

<p><br /></p>

<h2 id="displaying-the-polls-on-the-homepage">Displaying the polls on the homepage</h2>
<p>To display the polls we’re going to create two new react components (to manage state properly).</p>

<p>These components would work together to Load polls from the server and on each vote, increment the vote counter for a poll and refresh the UI (fetch polls from the server again)</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">LivePreviewProps</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="na">voteHandler</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>

    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span>  <span class="nx">origin</span> <span class="o">+</span> <span class="s1">'/api/poll/vote'</span>

    <span class="c1">// make patch request</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
      <span class="na">dataType</span><span class="p">:</span> <span class="s1">'json'</span><span class="p">,</span>
      <span class="na">type</span><span class="p">:</span> <span class="s1">'PATCH'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
      <span class="na">contentType</span><span class="p">:</span> <span class="s1">'application/json; charset=utf-8'</span><span class="p">,</span>
      <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">selected_option</span><span class="p">:</span> <span class="s1">''</span><span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">loadPollsFromServer</span><span class="p">();</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
      <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">'Poll creation failed: '</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">});</span>

  <span class="p">},</span>


  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">polls</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">polls</span><span class="p">.</span><span class="nx">Polls</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">poll</span><span class="p">){</span>
      <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">LivePreview</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span> <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span> <span class="nx">options</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">options</span><span class="p">}</span>
        <span class="nx">total_vote_count</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">total_vote_count</span><span class="p">}</span> <span class="nx">voteHandler</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">voteHandler</span><span class="p">}</span>
        <span class="nx">classContext</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">classContext</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
    <span class="p">);</span>
  <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h1</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">Align</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">header</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"row"</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">polls</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<p>Create another component <code class="highlighter-rouge">AllPolls</code> that loads the polls from the server</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">AllPolls</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="na">getInitialState</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">polls</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Polls'</span><span class="p">:</span> <span class="p">[]},</span> <span class="na">header</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">classContext</span><span class="p">:</span> <span class="s1">''</span><span class="p">};</span>
  <span class="p">},</span>

  <span class="na">loadPollsFromServer</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span>  <span class="nx">origin</span> <span class="o">+</span> <span class="s1">'/api/polls'</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">header</span><span class="p">:</span> <span class="s1">'Latest polls'</span><span class="p">,</span> <span class="na">classContext</span><span class="p">:</span> <span class="s1">'col-sm-6'</span><span class="p">})</span>

    <span class="c1">//make get request</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
      <span class="na">dataType</span><span class="p">:</span> <span class="s1">'json'</span><span class="p">,</span>
      <span class="na">cache</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">polls</span><span class="p">:</span> <span class="nx">data</span><span class="p">});</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
      <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="na">componentDidMount</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loadPollsFromServer</span><span class="p">()</span>
  <span class="p">},</span>

  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="o">&lt;</span><span class="nx">LivePreviewProps</span> <span class="nx">polls</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">polls</span><span class="p">}</span> <span class="nx">loadPollsFromServer</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">loadPollsFromServer</span><span class="p">}</span>
    <span class="nx">header</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">header</span><span class="p">}</span> <span class="nx">classContext</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">classContext</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
  <span class="p">}</span>

<span class="p">});</span></code></pre></figure>

<p>Your ReactDOM.render method should include a new route to the homepage that invokes the new <code class="highlighter-rouge">AllPolls</code> component</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">((</span>
  <span class="o">&lt;</span><span class="nx">Router</span> <span class="nx">history</span><span class="o">=</span><span class="p">{</span><span class="nx">browserHistory</span><span class="p">}</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">AllPolls</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/polls"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">PollForm</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/Router</span><span class="err">&gt;
</span>
  <span class="p">),</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'container'</span><span class="p">)</span>
<span class="p">);</span></code></pre></figure>

<p><br /></p>

<h2 id="passing-methods-as-props">Passing methods as props</h2>

<p>The unique thing is how we handle the state of the polls here <strong><em>in AllPolls</em></strong></p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">LivePreviewProps</span> <span class="nx">polls</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">polls</span><span class="p">}</span> <span class="nx">loadPollsFromServer</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">loadPollsFromServer</span><span class="p">}</span>
<span class="nx">header</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">header</span><span class="p">}</span> <span class="nx">classContext</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">classContext</span><span class="p">}</span> <span class="sr">/&gt;</span></code></pre></figure>

<p>and here in <strong><em>LivePreviewProps</em></strong></p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">LivePreview</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span> <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span> <span class="nx">options</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">options</span><span class="p">}</span>
<span class="nx">total_vote_count</span><span class="o">=</span><span class="p">{</span><span class="nx">poll</span><span class="p">.</span><span class="nx">total_vote_count</span><span class="p">}</span> <span class="nx">voteHandler</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">voteHandler</span><span class="p">}</span>
<span class="nx">classContext</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">classContext</span><span class="p">}</span> <span class="sr">/&gt;</span></code></pre></figure>

<p>We’re passing in the <code class="highlighter-rouge">loadPollsFromServer</code> method as a prop to the <code class="highlighter-rouge">LivePreviewProps</code> component.</p>

<p>The <code class="highlighter-rouge">LivePreviewProps</code> component also passes it’s <code class="highlighter-rouge">voteHandler</code> method as a prop to <code class="highlighter-rouge">LivePreview</code> component which it uses to handle votes calling <code class="highlighter-rouge">this.props.voteHandler()</code></p>

<p>the <code class="highlighter-rouge">voteHandler</code> method in <code class="highlighter-rouge">LivePreviewProps</code> then processes the votes
and refreshes the UI by calling the prop that was passed to it using <code class="highlighter-rouge">this.props.loadPollsFromServer()</code> which eventually fetches the polls from the database and updates the UI accordingly.</p>

<p>React allows you to pass in methods as props to child components and then in the child component you can use those props as callbacks for various events.</p>

<p>This is also simple way to simulate <a href="https://facebook.github.io/react/docs/two-way-binding-helpers.html">two way data-binding</a> (Data flowing seamlessly between parent and child) in react <strong><em>Technically it’s not</em></strong> but it enables data to flow from parent to child and vice versa.</p>

<p><em><code class="highlighter-rouge">classContext</code> is a state variable we use to set the bootstrap class of the <code class="highlighter-rouge">LivePreview</code> component based on where it is rendered</em></p>

<p>You should be able to see the list of all the previous polls you created as <code class="highlighter-rouge">LivePreview</code> components, but if you click on the vote button it wouldn’t do anything now because we haven’t implemented the <code class="highlighter-rouge">voteHandler</code> method of the <code class="highlighter-rouge">LivePreview</code> component.</p>

<p>To do that we’re going to define some states in <code class="highlighter-rouge">LivePreview</code> to keep track of the selected option and another to control the activeness of the button (the button should be disabled after a user casts their vote). We’re also adding a new method <code class="highlighter-rouge">voteHandler</code> that would be triggered anytime the vote button is clicked (When the form is submitted)</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">LivePreview</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="na">getInitialState</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">selected_option</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">disabled</span><span class="p">:</span> <span class="mi">0</span><span class="p">};</span>
  <span class="p">},</span>

  <span class="na">handleOptionChange</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">selected_option</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span> <span class="p">});</span>
  <span class="p">},</span>


  <span class="na">voteHandler</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

    <span class="c1">// build the json data</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"poll_title"</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="s2">"option"</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selected_option</span><span class="p">};</span>

    <span class="c1">//calls props handler</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">voteHandler</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

    <span class="c1">//disable the button</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">disabled</span><span class="p">:</span> <span class="mi">1</span><span class="p">});</span>

  <span class="p">},</span>

  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">option</span><span class="p">){</span>

      <span class="k">if</span><span class="p">(</span><span class="nx">option</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">option</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"options"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"radio"</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">option</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOptionChange</span><span class="p">}</span> <span class="sr">/&gt; {option.name</span><span class="err">}
</span>            <span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
        <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>

    <span class="k">return</span><span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"panel panel-success"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"panel-heading"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">h4</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h4</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"panel-body"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">voteHandler</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="p">{</span><span class="nx">options</span><span class="p">}</span>
            <span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nx">disabled</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">disabled</span><span class="p">}</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-success btn-outline hvr-grow"</span><span class="o">&gt;</span><span class="nx">Vote</span><span class="o">!&lt;</span><span class="sr">/button&gt; &lt;small&gt;{this.props.total_vote_count} votes so far&lt;/</span><span class="nx">small</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<p>Your polls should like this now:</p>

<p><img src="/images/flask-6-poll-sample.png" alt="Sample poll" /></p>

<p>Cool! But we don’t have progress bars to show who’s leading the polls and the exact percentage by which they’re leading.</p>

<p>To achieve that we’re going to use bootstrap3 progress bars, HTML 5 also has progress bars but the bootstrap progress bars have already been styled for us and they also provide a nice animation when they’re updated (it’s almost like it was built with react in mind). Thanks bootstrap!</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">render</span><span class="err">:</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">option</span><span class="p">){</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">option</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// calculate progress bar percentage</span>
      <span class="kd">var</span> <span class="nx">progress</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">option</span><span class="p">.</span><span class="nx">vote_count</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">total_vote_count</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span>
      <span class="kd">var</span> <span class="nx">current</span> <span class="o">=</span> <span class="p">{</span><span class="na">width</span><span class="p">:</span> <span class="nx">progress</span><span class="o">+</span><span class="s2">"%"</span><span class="p">}</span>

      <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">option</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"options"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"radio"</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">option</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOptionChange</span><span class="p">}</span> <span class="sr">/&gt; {option.name</span><span class="err">}
</span>          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"progress"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"progress-bar progress-bar-success"</span> <span class="nx">role</span><span class="o">=</span><span class="s2">"progressbar"</span> <span class="nx">aria</span><span class="o">-</span><span class="nx">valuenow</span><span class="o">=</span><span class="p">{</span><span class="nx">progress</span><span class="p">}</span>
            <span class="nx">aria</span><span class="o">-</span><span class="nx">valuemin</span><span class="o">=</span><span class="s2">"0"</span> <span class="nx">aria</span><span class="o">-</span><span class="nx">valuemax</span><span class="o">=</span><span class="s2">"100"</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">current</span><span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span><span class="nx">progress</span><span class="p">}</span><span class="o">%</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
          <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
      <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span></code></pre></figure>

<p>Pretty straight-forward math. Now we have a progress bar that shows us the percentage of votes each option has. progress bar percentage and the total vote count should update as soon as you cast your vote on any poll.</p>

<p><br /></p>

<h3 id="permalinks-for-polls">Permalinks for polls</h3>

<p>Until now, we’ve fetched all the from the database and displayed them on the homepage, that works perfectly. But this is not really ideal because what we really want is to have a link to a single poll. we can then share this links with our friends so they can also cast their votes.</p>

<p>Without this, they’ll have to sift through all the polls on the homepage before they can find the poll they’re looking for.</p>

<p>Lets create two new routes in <code class="highlighter-rouge">votr.py</code></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nd">@votr.route</span><span class="p">(</span><span class="s">'/polls/&lt;poll_name&gt;'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="n">poll_name</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>

<span class="nd">@votr.route</span><span class="p">(</span><span class="s">'/api/poll/&lt;poll_name&gt;'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">api_poll</span><span class="p">(</span><span class="n">poll_name</span><span class="p">):</span>
    <span class="n">poll</span> <span class="o">=</span> <span class="n">Topics</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">Topics</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">poll_name</span><span class="p">))</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'Polls'</span><span class="p">:</span> <span class="p">[</span><span class="n">poll</span><span class="o">.</span><span class="n">to_json</span><span class="p">()]})</span> <span class="k">if</span> <span class="n">poll</span> <span class="k">else</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'poll not found'</span><span class="p">})</span></code></pre></figure>

<p>The first route accepts an arbitrary named url parameter <code class="highlighter-rouge">&lt;poll_name&gt;</code> and returns the index.html template back</p>

<p>The second one is an api endpoint that uses the <code class="highlighter-rouge">&lt;poll_name&gt;</code> to search the db for a particular poll and returns the result as json if the poll was found, else it returns a message back.</p>

<p>Go back to the <code class="highlighter-rouge">polls.js</code> file and add a new React Router route</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">((</span>
  <span class="o">&lt;</span><span class="nx">Router</span> <span class="nx">history</span><span class="o">=</span><span class="p">{</span><span class="nx">browserHistory</span><span class="p">}</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">AllPolls</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/polls"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">PollForm</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/polls/:pollName"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">AllPolls</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
  <span class="o">&lt;</span><span class="sr">/Router</span><span class="err">&gt;
</span>
  <span class="p">),</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'container'</span><span class="p">)</span>
<span class="p">);</span></code></pre></figure>

<p>The new route <code class="highlighter-rouge">&lt;Route path="/polls/:pollName" component={AllPolls} /&gt;</code> is basically the same as it’s flask counterpart with an arbitrary value for <code class="highlighter-rouge">:pollName</code> for the poll name</p>

<p>We’re also re-using the <code class="highlighter-rouge">AllPolls</code> component, which means we’ll have to make it smart enough to know which Route called it. Luckily the Route that called it is available to us as a prop.</p>

<p>In this case <code class="highlighter-rouge">this.props.routeParams.pollName</code></p>

<p>Update the <code class="highlighter-rouge">AllPolls</code> component</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">AllPolls</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="na">getInitialState</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">polls</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Polls'</span><span class="p">:</span> <span class="p">[]},</span> <span class="na">header</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">classContext</span><span class="p">:</span> <span class="s1">''</span><span class="p">};</span>
  <span class="p">},</span>

  <span class="na">loadPollsFromServer</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="c1">// pollName is available as a prop</span>
    <span class="kd">var</span> <span class="nx">pollName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">routeParams</span><span class="p">.</span><span class="nx">pollName</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">pollName</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">origin</span> <span class="o">+</span> <span class="s1">'/api/poll/'</span> <span class="o">+</span> <span class="nx">pollName</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">classContext</span><span class="p">:</span> <span class="s1">'col-sm-6 col-sm-offset-3'</span><span class="p">})</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">origin</span> <span class="o">+</span> <span class="s1">'/api/polls'</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">header</span><span class="p">:</span> <span class="s1">'Latest polls'</span><span class="p">,</span> <span class="na">classContext</span><span class="p">:</span> <span class="s1">'col-sm-6'</span><span class="p">})</span>
    <span class="p">}</span>

    <span class="c1">//make get request</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
      <span class="na">dataType</span><span class="p">:</span> <span class="s1">'json'</span><span class="p">,</span>
      <span class="na">cache</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">polls</span><span class="p">:</span> <span class="nx">data</span><span class="p">});</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
      <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="na">componentDidMount</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loadPollsFromServer</span><span class="p">()</span>
  <span class="p">},</span>

  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="c1">// if a message was returned in the json result (the poll wasn't found)</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">polls</span><span class="p">.</span><span class="nx">message</span><span class="p">){</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">LivePreviewProps</span> <span class="nx">polls</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">polls</span><span class="p">}</span> <span class="nx">loadPollsFromServer</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">loadPollsFromServer</span><span class="p">}</span>
      <span class="nx">header</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">header</span><span class="p">}</span> <span class="nx">classContext</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">classContext</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
      <span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">Align</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Poll</span> <span class="nx">not</span> <span class="nx">found</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>
            <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">You</span> <span class="nx">might</span> <span class="nx">be</span> <span class="nx">interested</span> <span class="k">in</span> <span class="nx">these</span> <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"/"</span><span class="o">&gt;</span><span class="nx">polls</span><span class="o">&lt;</span><span class="sr">/a&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
        <span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span></code></pre></figure>

<p>We simply checked if the <code class="highlighter-rouge">pollName</code> was set in the url and based on that we set the url that we want to query (and the style and header content we want to show).</p>

<p>We also modified the render method to display a message to the user if they requested for a poll that didn’t exist in the database</p>

<p>The <code class="highlighter-rouge">AllPolls</code> component is now flexible enough to fetch all the polls or a single poll depending on how it was invoked.</p>

<p><br /></p>

<h3 id="extra-tweaks">Extra tweaks</h3>
<p>Let’s make the homepage display two polls on each row, and the permalink page display one poll.</p>

<p>We already planned this ahead with the <code class="highlighter-rouge">classContext</code> variable from <code class="highlighter-rouge">AllPolls</code>, all we need to do is to use it as a <code class="highlighter-rouge">div</code> surrounding the <code class="highlighter-rouge">panel panel-success</code> div.</p>

<p>Change the return value of <code class="highlighter-rouge">LivePreview</code>’s render method to this.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">return</span><span class="p">(</span>

  <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">classContext</span><span class="p">}</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"panel panel-success"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"panel-heading"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h4</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h4</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"panel-body"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">voteHandler</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">options</span><span class="p">}</span>
          <span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nx">disabled</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">disabled</span><span class="p">}</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-success btn-outline hvr-grow"</span><span class="o">&gt;</span><span class="nx">Vote</span><span class="o">!&lt;</span><span class="sr">/button&gt; &lt;small&gt;{this.props.total_vote_count} votes so far&lt;/</span><span class="nx">small</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="p">)</span></code></pre></figure>

<p>also change the render method of <code class="highlighter-rouge">PollForm</code> to this (to center the LivePreview form on the create polls page)</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">render</span><span class="err">:</span> <span class="kd">function</span><span class="p">(){</span>

  <span class="kd">var</span> <span class="nx">classContext</span> <span class="o">=</span> <span class="s2">"col-sm-6 col-sm-offset-3"</span>

  <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"poll_form"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-signin"</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-signin-heading"</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">Align</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Create</span> <span class="nx">a</span> <span class="nx">poll</span><span class="o">&lt;</span><span class="sr">/h2</span><span class="err">&gt;
</span>

          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-group has-success"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span> <span class="nx">htmlFor</span><span class="o">=</span><span class="s2">"title"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"sr-only"</span><span class="o">&gt;</span><span class="nx">Title</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>
            <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"title"</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"title"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Title"</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleTitleChange</span><span class="p">}</span> <span class="nx">required</span> <span class="nx">autoFocus</span> <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>

          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-group has-success"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span> <span class="nx">htmlFor</span><span class="o">=</span><span class="s2">"option"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"sr-only"</span><span class="o">&gt;</span><span class="nx">Option</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>
            <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">list</span><span class="o">=</span><span class="s2">"option"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Option"</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOptionChange</span><span class="p">}</span>
            <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">option</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">option</span><span class="p">:</span> <span class="s1">''</span><span class="p">}</span> <span class="nx">autoFocus</span> <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>

          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"row form-group"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-lg btn-success btn-block"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"button"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOptionAdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Add</span> <span class="nx">option</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>
            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-lg btn-success btn-block"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">&gt;</span><span class="nx">Save</span> <span class="nx">poll</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"row"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h3</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">Align</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Live</span> <span class="nx">Preview</span><span class="o">&lt;</span><span class="sr">/h3</span><span class="err">&gt;
</span>
          <span class="o">&lt;</span><span class="nx">LivePreview</span> <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span> <span class="nx">options</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">options</span><span class="p">}</span> <span class="nx">classContext</span><span class="o">=</span><span class="p">{</span><span class="nx">classContext</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<p>Reload the view and now you should see two polls on each row on the homepage, while the preview form on the create poll page should remain centered.</p>

<p>Now you should understand what <code class="highlighter-rouge">classContext</code> does for us.</p>

<p><br /></p>

<h2 id="improve-the-create-poll-form">Improve the create poll form</h2>

<p>Remember in the previous tutorial where we prevented duplicate options in our database by linking existing options with the poll, we’re going to do something similar on the front-end, but this time we’re going to show them existing options as they type, so instead of typing the full name of an option they can easily see the results filtered out in real time as they type and easily pick the option from the list</p>

<p>Something along the lines of:</p>

<p>To do that, we’ll simply retrieve all the options form the api endpoint we created earlier (<code class="highlighter-rouge">'/api/poll/options'</code>)</p>

<p>and Then edit the render method of the <code class="highlighter-rouge">PollForm</code> component to fetch those results and use them as the options of a new <code class="highlighter-rouge">datalist</code> element</p>

<p>This is our PollForm component in all it’s glory.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">PollForm</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="na">getInitialState</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="c1">// set initial state of form inputs</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">title</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">option</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">options</span><span class="p">:</span> <span class="p">[],</span> <span class="na">all_options</span><span class="p">:</span> <span class="p">[]}</span>
  <span class="p">},</span>

  <span class="na">handleTitleChange</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="c1">//change title as the user types</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">title</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
  <span class="p">},</span>

  <span class="na">handleOptionChange</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">option</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
  <span class="p">},</span>

  <span class="na">handleOptionAdd</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="c1">//update poll options and reset options to an empty string</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
    <span class="na">options</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">concat</span><span class="p">({</span><span class="na">name</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">option</span><span class="p">}),</span>
    <span class="na">option</span><span class="p">:</span> <span class="s1">''</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="na">componentDidMount</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span>  <span class="nx">origin</span> <span class="o">+</span> <span class="s1">'/api/polls/options'</span>

    <span class="c1">//get all options</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
      <span class="na">dataType</span><span class="p">:</span> <span class="s1">'json'</span><span class="p">,</span>
      <span class="na">cache</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">all_options</span><span class="p">:</span> <span class="nx">data</span><span class="p">});</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
      <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">});</span>

  <span class="p">},</span>

  <span class="na">handleSubmit</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'title'</span><span class="p">:</span> <span class="nx">title</span><span class="p">,</span> <span class="na">options</span><span class="p">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">name</span><span class="p">})};</span>
    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span>  <span class="nx">origin</span> <span class="o">+</span> <span class="s1">'/api/polls'</span>

    <span class="c1">// make post request</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
      <span class="na">dataType</span><span class="p">:</span> <span class="s1">'json'</span><span class="p">,</span>
      <span class="na">type</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
      <span class="na">contentType</span><span class="p">:</span> <span class="s1">'application/json; charset=utf-8'</span><span class="p">,</span>
      <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
      <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">err</span><span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">'Poll creation failed: '</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="kd">var</span> <span class="nx">classContext</span> <span class="o">=</span> <span class="s2">"col-sm-6 col-sm-offset-3"</span>

    <span class="kd">var</span> <span class="nx">all_options</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">all_options</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">option</span><span class="p">){</span>
                        <span class="k">return</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">option</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">option</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">option</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">)
</span>
                      <span class="p">});</span>

    <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"poll_form"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-signin"</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-signin-heading"</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">Align</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Create</span> <span class="nx">a</span> <span class="nx">poll</span><span class="o">&lt;</span><span class="sr">/h2</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-group has-success"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">label</span> <span class="nx">htmlFor</span><span class="o">=</span><span class="s2">"title"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"sr-only"</span><span class="o">&gt;</span><span class="nx">Title</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>
          <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"title"</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"title"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Title"</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleTitleChange</span><span class="p">}</span> <span class="nx">required</span> <span class="nx">autoFocus</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>

        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-group has-success"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">label</span> <span class="nx">htmlFor</span><span class="o">=</span><span class="s2">"option"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"sr-only"</span><span class="o">&gt;</span><span class="nx">Option</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>
          <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">list</span><span class="o">=</span><span class="s2">"option"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Option"</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOptionChange</span><span class="p">}</span>
          <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">option</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">option</span><span class="p">:</span> <span class="s1">''</span><span class="p">}</span> <span class="nx">autoFocus</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>

        <span class="o">&lt;</span><span class="nx">datalist</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"option"</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">all_options</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="sr">/datalist</span><span class="err">&gt;
</span>

        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"row form-group"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-lg btn-success btn-block"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"button"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOptionAdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Add</span> <span class="nx">option</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>
          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-lg btn-success btn-block"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">&gt;</span><span class="nx">Save</span> <span class="nx">poll</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>

      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"row"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h3</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">Align</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Live</span> <span class="nx">Preview</span><span class="o">&lt;</span><span class="sr">/h3</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">LivePreview</span> <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span> <span class="nx">options</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">options</span><span class="p">}</span> <span class="nx">classContext</span><span class="o">=</span><span class="p">{</span><span class="nx">classContext</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<p>You’ve now added an autocomplete Text box, that assists the user by showing them pre-existing options as they type, though our backend already prevent duplicates, this is still a nice feature to have in our web application</p>

<p>One last thing is left for the homepage, we want to sort the polls in descending order and make sure we only display opened polls. Just change your query in <code class="highlighter-rouge">api_polls</code> to</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">polls</span> <span class="o">=</span> <span class="n">Topics</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Polls</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Topics</span><span class="o">.</span><span class="nb">id</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span></code></pre></figure>

<p>Well that’s all for this part, Here’s a gif of me casting my vote on the Fastest player in the English premier league :)</p>

<p><img src="/images/votr.gif" alt="Fastest player in the English premier league" /></p>

<p><br /></p>

<h2 id="missing-features-and-general-advice">Missing features and general advice</h2>
<ul>

<li>Users have no profile page to manage the polls they've created</li>

<br />

<li>Even though we disabled the vote button after voting, our users can still reload the page and vote on the same option again!
</li>

<br />

<li>As our web app is still it's pretty efficient to fetch the whole chunk of json for the poll and options in one request, as your application grows this may become very inefficient as it would be pointless to load a whole lot of information that your user may not need, you'd also be putting a lot of stress on your database too

<br />

imagine fectcing a huge list of 200k+ polls in one go. Your application would seem very slow to users with slow internet connections.
<br /><br />
  <ul class="postlist">

  <li>
  To handle this you might want want to limit the polls you display on the homepage and then update it as the user scrolls
  </li>

  <li>
  For the options you can listen to the <strong>onChange</strong> event of the text field and use the current value to make a request to the server
  </li>

  <br />

<blockquote>
The goal here is to make little requests as they're needed (returning relevant information the user is interested  in) not a single expensive request that comes back with a lot of info that the user doesn't need
</blockquote>

  </ul>

</li>

</ul>

<p><br /></p>

<h2 id="conclusion">Conclusion</h2>
<p>Now our voting application is gradually coming to life, Users can create polls and other users can vote on them.</p>

<p>We also implemented interactive progress bars to show the users the standings of the each option in a poll.</p>

<p>We aren’t going to do a lot of “new” React stuff as we progress in this tutorial, but i hope you seen the beauty of React and have fallen in love with this amazing Javascript library.</p>

<p>React is way more powerful and flexible than what you’ve seen in this tutorial. This is just the tip of the ice-berg to what you can accomplish with React.</p>

<p>You should be strong enough to venture into the huge ecosystem of react tutorials and addons that awaits you.</p>

<p><br /></p>

<h3 id="what-are-we-hacking-at-next">What are we hacking at next?</h3>
<p>In the next part we’re going to build an admin panel to manage the polls as the admin user and also a control panel for users to manage their polls (You should have enough flask knowledge to this on your own don’t panic if you don’t everyone learns at different speed)</p>

<p>We’re also going to add more control to our application to keep track of <em>Fraudulent</em> and <em>Overzealous</em> users who most likely would want to vote ona poll more than once.</p>

<p>We’re also going to implement a new feature where users can set the duration that they want a poll to be active (similar to twitter polls)</p>

<p>You might want to look up <a href="http://www.celeryproject.org/">Celery</a> before then.</p>

<p>If you’re enjoyed this part, please drop a comment I’d love it and you can consider sharing this post and following me on <a href="https://twitter.com/osaetindaniel">twitter</a></p>

<p>See you in the next part. Cheers!</p>

            </div>

            <br />

            <hr>

            <div class="share-page">
                Share this post on &rarr;
                <a href="https://twitter.com/intent/tweet?text=Flask by example 6 (Connecting React to a REST API)&url=https://danidee10.github.io/2016/10/26/flask-by-example-6.html&via=osaetindaniel&related=osaetindaniel" rel="nofollow" target="_blank" title="Share on Twitter">Twitter</a> |
                <a href="https://facebook.com/sharer.php?u=https://danidee10.github.io/2016/10/26/flask-by-example-6.html" rel="nofollow" target="_blank" title="Share on Facebook">Facebook</a> |
                <a href="https://plus.google.com/share?url=https://danidee10.github.io/2016/10/26/flask-by-example-6.html" rel="nofollow" target="_blank" title="Share on Google+">Google+</a>
            </div>

        <hr>

        <aside id="comments" class="disqus">
          <div class="container">
            <h3><i class="fa fa-comments-o"></i> Comments</h3>
            <div id="disqus_thread"></div>
            <script>



              var disqus_config = function() {
                this.page.url = 'https://danidee10.github.io/2016/10/26/flask-by-example-6.html'; //shouldn't hardoce this
                this.page.identifier = 'Flask by example 6 (Connecting React to a REST API)';
              };
              (function() {
                var d = document,
                s = d.createElement('script');
                s.src = '//osaetin-daniel.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
              })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
          </div>
        </aside>

          </div>

        </article>

      </div>

      <footer class="site-footer">
  <div class="container">
    <ul class="social">
      <li><a href="http://github.com/danidee10" target="_blank"><i class="fa fa-github"></i></a></li>
      <li><a href="http://twitter.com/osaetindaniel" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
      <li><a href="https://www.facebook.com/osaetin.daniel" target="_blank"><i class="fa fa-facebook"></i></a></li>
      <li><a href="https://www.linkedin.com/in/osaetin-daniel-87604098" target="_blank"><i class="fa fa-linkedin"></i></a></li>
    </ul>
    <p class="txt-medium-gray">
      <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small>
    </p>
  </div>
</footer>


<a href="https://github.com/danidee10" target="_blank" class="github-corner"><svg width="50" height="50" viewBox="0 0 250 250" style="fill:#337ab7; color:#fff; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script>
$(document).ready(function() {
  $('.sliding-panel-button,.sliding-panel-fade-screen,.sliding-panel-close').on('click touchstart',function (e) {
    $('.sliding-panel-content,.sliding-panel-fade-screen').toggleClass('is-visible');
    e.preventDefault();
  });
});
</script>

    </main>
  </body>
</html>
